function InBrowserTutorial(n){this._options=$.extend({},{stepCount:7},n||{});this._editor=null;this._init()}function recordStepStarted(n){var t={behavior:20,actionType:"CL",contentTags:{scn:"In-Browser Tutorial",stpnum:n}};captureAction(t)}function recordStepCompleted(n){var t={behavior:22,actionType:"CL",contentTags:{scn:"In-Browser Tutorial",issuccess:"true",stpnum:n}};captureAction(t)}function recordStepFailed(n){var t={behavior:23,actionType:"CL",contentTags:{scn:"In-Browser Tutorial",issuccess:"false",stpnum:n}};captureAction(t)}$(function(){$('[data-toggle="tooltip"]').tooltip();var n=new InBrowserTutorial({})});InBrowserTutorial.prototype._init=function(){var t=this._getCode(initStep),n=this;this._updateNames();this._editor=new CodeEditor({onNextStep:n._editorOnNextStep.bind(n),onInitComplete:n._editorOnInitComplete.bind(n),onRunBefore:n._editorOnRunBefore.bind(n),onRunDone:n._editorOnRunDone.bind(n),onRunFail:n._editorOnRunFail.bind(n),defaultCode:t,workspaceType:"script"});recordStepStarted(initStep)};InBrowserTutorial.prototype._editorOnNextStep=function(){this._nextStep()};InBrowserTutorial.prototype._editorOnInitComplete=function(){$(".step-toc a").click($.proxy(function(n){var t=$(n.target),i=t.data("stepNumber");this._loadInitialStep(i)},this));$(".show-me").click($.proxy(function(n){var t=$(n.target);this._showMeCode(t)},this));$(".step-back").click($.proxy(function(){this._loadNewStep(this._options.stepCount-1)},this))};InBrowserTutorial.prototype._editorOnRunBefore=function(){$("#button-next").hide();var n=this._getCurrentStep(),t=this._editor.getCode();return this._validateCode(n,t)};InBrowserTutorial.prototype._validateCode=function(n,t){var i=!0;switch(n){case 3:if(t.indexOf("var")<0){i=!1;this._showInvalidMessage("Hint: Expected to find <code>var<\/code> in your code");break}break;case 4:if(t.indexOf("$")<0){i=!1;this._showInvalidMessage("Hint: Expected to find <code>$<\/code> in your code");break}}return i||recordStepFailed(n,"Code validation did not pass"),i};InBrowserTutorial.prototype._editorOnRunDone=function(n){var t=this._getCurrentStep(),u,r,i;if(n&&n.succeeded){if(u=this._validateOutput(t,n.output),!u)return;if(recordStepCompleted(t),t==this._options.stepCount-1&&window.setTimeout(this._loadStepFinal.bind(this),2e3),t<this._options.stepCount-1&&this._editor.showNextButton(),this._showSuccessMessage(),r=this._editor.getCode(),typeof Storage!="undefined")for(localStorage.setItem("step-"+t,r),t<this._options.stepCount&&localStorage.setItem("step-"+(t+1),r),i=t+2;i<=this._options.stepCount;i++)localStorage.removeItem("step-"+i)}else this._editor.hideNextButton(),recordStepFailed(t,"Compilation failed")};InBrowserTutorial.prototype._validateOutput=function(n,t){var r=!0,i=this._getName(),u,f;switch(n){case 2:i=$.trim(t.split("<br />")[0].replace(/hello/ig,"").replace(/world/ig,"").replace("!",""));i.length<1?(this._showInvalidMessage("Hint: Replace the word <code>World<\/code> with your name."),r=!1):this._setName(i);break;case 3:t.indexOf(i)<0&&(r=!1,this._showInvalidMessage("Hint: Expected to see <b>"+i+"<\/b> in the output"));break;case 4:t.indexOf("{name}")>=0&&(r=!1,this._showInvalidMessage("Hint: Make sure you include the <code>$<\/code> at the start of the string"));t.indexOf(i)<0&&(r=!1,this._showInvalidMessage("Hint: Expected to see <b>"+i+"<\/b> in the output"));break;case 5:if(i){u=i.toUpperCase();t.indexOf(u)<0&&(r=!1,this._showInvalidMessage("Hint: Expected to see <b>"+u+"<\/b> in the output"));break}case 6:f=(t.match(/Hello/g)||[]).length;f<3&&(r=!1,this._showInvalidMessage("Hint: Expected to see Hello multiple times in the output"))}return r||recordStepFailed(n,"Output validation did not pass"),r};InBrowserTutorial.prototype._editorOnRunFail=function(){this._editor.hideNextButton()};InBrowserTutorial.prototype._loadNewStep=function(n){var t=window.location.pathname.substr(0,window.location.pathname.lastIndexOf("/")+1)+n;window.history.pushState({id:1},"",t);this._loadInitialStep(n)};InBrowserTutorial.prototype._loadInitialStep=function(n){var t=this;$(".step-toc li").removeClass("active").removeClass("done");$(".step-toc li").each(function(i){var u=i+1,r=$(this).children(":first").data("original-title");u<n||n==t._options.stepCount?($(this).addClass("done"),$(this).children(":first").attr("aria-label",r+" completed step"),document.title=".NET In-Browser Tutorial - "+r):u==n?($(this).addClass("active"),$(this).children(":first").attr("aria-label",r+" current step"),document.title=".NET In-Browser Tutorial - "+r):$(this).children(":first").attr("aria-label",r)});this._updateNames();$(".step").hide();$(".step-"+n).show();n<this._options.stepCount&&($(".steps-code").show(),$(".steps-final").hide());n==this._options.stepCount&&($(".steps-final").show(),$(".steps-code").hide());this._editor.hideNextButton();this._editor.hideAlert();$("#output-window").html("");this._loadCode(n);recordStepStarted(n)};InBrowserTutorial.prototype._updateNames=function(){var n=this._getName();$(".step pre.language-csharp code").each(function(){$(this).html($(this).html().replace("&lt;name&gt;","<span class='name'>"+n+"<\/span>"));$(".name").html(n)})};InBrowserTutorial.prototype._getCode=function(n){var t,r,u,i;return typeof Storage!="undefined"&&localStorage.getItem("step-"+n)!==null?localStorage.getItem("step-"+n):(t=this._getCurrentStep(),r=t==1?1:t-1,t==this._options.stepCount)?"":(u=this._getName(),i=$(".step-"+r+" pre.d-none:last-child code").html(),i.replace(/&lt;name&gt;/g,u))};InBrowserTutorial.prototype._loadCode=function(n){var t=this._getCode(n);this._updateEditor(t,!0)};InBrowserTutorial.prototype._nextStep=function(){var n=this._getCurrentStep();this._loadNewStep(n+1);$(window).scrollTop(0)};InBrowserTutorial.prototype._loadStepFinal=function(){this._loadNewStep(this._options.stepCount);$(window).scrollTop(0)};InBrowserTutorial.prototype._getCurrentStep=function(){return $(".steps-final").is(":visible")?this._options.stepCount:parseInt($(".step:visible").data("stepNumber"))};InBrowserTutorial.prototype._showMeCode=function(n){var t=n.parent().next().find("code").html();this._updateEditor(t,!1);this._editor.focusEditor()};InBrowserTutorial.prototype._updateEditor=function(n,t){if(typeof n!="undefined"&&typeof this._editor!="undefined"){var i=this._getName();n=n.replace(/&lt;name&gt;/g,i);this._editor.updateCode(n,t)}};InBrowserTutorial.prototype._showSuccessMessage=function(){var i=this._getCurrentStep(),n,t;switch(i){case 1:n="Nice! Select <b>Next Step<\/b> to keep learning.";break;case 2:t=this._getName();n="Hey "+t+"! Let's keep coding.";break;case 3:case 4:case 5:n="Good job! Let's keep coding.";break;case 6:n="Good job!";break;case 7:return}this._editor.setAlert(n,"success")};InBrowserTutorial.prototype._showInvalidMessage=function(n){this._editor.setAlert(n,"warning")};InBrowserTutorial.prototype._setName=function(n){typeof Storage!="undefined"&&localStorage.setItem("step-name",n)};InBrowserTutorial.prototype._getName=function(){if(typeof Storage!="undefined"){var n=localStorage.getItem("step-name");return typeof htmlEncode=="function"&&n!==null&&(n=htmlEncode(n)),n}return"Ana"};